<p style="color: green"><%= notice %></p>

<h1>Books</h1>

<!-- Filtering Form -->
<div class="mb-4">
  <%= form_with url: books_path, method: :get, local: true, class: "row g-3 align-items-end" do %>
    <div class="col-md-3">
      <%= label_tag :author_id, "Author", class: "form-label" %>
      <%= select_tag :author_id, options_from_collection_for_select(Author.all, :id, :name, params[:author_id]), include_blank: "All Authors", class: "form-select" %>
    </div>

    <div class="col-md-3">
      <%= label_tag :category_id, "Category", class: "form-label" %>
      <%= select_tag :category_id, options_from_collection_for_select(Category.all, :id, :name, params[:category_id]), include_blank: "All Categories", class: "form-select" %>
    </div>

    <div class="col-md-3">
      <%= label_tag :title, "Title", class: "form-label" %>
      <%= text_field_tag :title, params[:title], class: "form-control", placeholder: "Search by Title" %>
    </div>

    <div class="col-md-3 d-flex gap-2">
      <%= submit_tag "Filter", class: "btn btn-primary btn-wide" %>
      <%= link_to "Reset", books_path, class: "btn btn-secondary btn-wide" %>
    </div>
  <% end %>
</div>

<div id="books">
  <table class="table table-striped table-hover">
    <thead>
      <tr>
        <th>Title</th>
        <th>Author</th>
        <th>Genre</th>
        <th>
          <%= link_to "Rating", books_path(params.permit(:author_id, :category_id, :title).merge(sort: "rating", direction: toggle_sort_direction("rating"))) %>
        </th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% @books.each do |book| %>
        <%= render book %>
      <% end %>
    </tbody>
  </table>
</div>

<div class="mt-3">
  <%= link_to "New Book", new_book_path, class: "btn btn-success" %>
</div>
<style>

</style>